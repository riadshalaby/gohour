{{ define "page" }}
<h1>Month overview: {{ .CurrentMonth }}</h1>
<div class="nav" style="margin-bottom:0.8rem;">
  <a href="/month/{{ .PreviousMonth }}">Previous</a>
  <a href="/month/{{ .NextMonth }}">Next</a>
  <button type="button" class="btn-primary" onclick="submitMonth('{{ .CurrentMonth }}')">Submit month</button>
  <button type="button" onclick="toggleImportForm('month-import-form')">Import file</button>
</div>
<form id="month-import-form" class="inline-form" hidden onsubmit="handleImportSubmit(event, { refreshURL: '/month/{{ .CurrentMonth }}' })">
  <input type="file" name="file" required>
  <select name="mapper">
    <option value="epm">epm</option>
    <option value="generic">generic</option>
    <option value="atwork">atwork</option>
  </select>
  <input type="text" name="project" placeholder="project (optional)">
  <input type="text" name="activity" placeholder="activity (optional)">
  <input type="text" name="skill" placeholder="skill (optional)">
  <button type="submit">Upload</button>
</form>
<div id="month-submit-result"></div>
<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Local Hours</th>
      <th>Remote Hours</th>
      <th>Delta</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    {{ range .Rows }}
    <tr>
      <td><span class="js-fmt-date" data-iso="{{ .Date }}">{{ .Date }}</span></td>
      <td><span class="js-fmt-hours" data-mins="{{ toMins .LocalHours }}">{{ toMins .LocalHours }}</span></td>
      <td><span class="js-fmt-hours" data-mins="{{ toMins .RemoteHours }}">{{ toMins .RemoteHours }}</span></td>
      <td>
        {{ if ge .DeltaHours 0.0 }}
        <span class="delta-pos js-fmt-delta" data-hours="{{ .DeltaHours }}">{{ fmtDelta .DeltaHours }}</span>
        {{ else }}
        <span class="delta-neg js-fmt-delta" data-hours="{{ .DeltaHours }}">{{ fmtDelta .DeltaHours }}</span>
        {{ end }}
      </td>
      <td><a href="{{ .DayLink }}">Open</a></td>
    </tr>
    {{ end }}
  </tbody>
  <tfoot>
    <tr>
      <th>Total</th>
      <th><span class="js-fmt-hours" data-mins="{{ toMins .TotalLocal }}">{{ toMins .TotalLocal }}</span></th>
      <th><span class="js-fmt-hours" data-mins="{{ toMins .TotalRemote }}">{{ toMins .TotalRemote }}</span></th>
      <th><span class="js-fmt-delta" data-hours="{{ .TotalDelta }}">{{ fmtDelta .TotalDelta }}</span></th>
      <th></th>
    </tr>
  </tfoot>
</table>
<div class="footer">Use month or day actions to import, edit, and submit.</div>
{{ end }}
